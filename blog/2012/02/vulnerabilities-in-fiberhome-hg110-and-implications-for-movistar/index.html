
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>Vulnerabilities in FiberHome HG110 and implications for Movistar</title>
    <meta name="description" content="">

    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="shortcut icon" href="/favicon.ico">

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="/assets/css/prism.css?v=c874ada865">
    <link rel="stylesheet" type="text/css" href="/assets/css/screen.css?v=c874ada865">
    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Merriweather:300,700,700italic,300italic%7COpen+Sans:700,400">

    <link rel="canonical" href="http://www.spect.cl/blog/2012/02/vulnerabilities-in-fiberhome-hg110-and-implications-for-movistar/">
    <meta name="referrer" content="origin">
    
    <meta property="og:site_name" content="SPECT Research">
    <meta property="og:type" content="article">
    <meta property="og:title" content="Vulnerabilities in FiberHome HG110 and implications for Movistar">
    <meta property="og:description" content="Update 1: Movistar, a day after this post was published, contacted me to solve the security problems. In this article I'll show two vulnerabilities found in the router FiberHome HG-110, provided by Movistar in large numbers to its clients in...">
    <meta property="og:url" content="http://www.spect.cl/blog/2012/02/vulnerabilities-in-fiberhome-hg110-and-implications-for-movistar/">
    <meta property="article:published_time" content="2012-02-22T12:00:00.000Z">
    <meta property="article:modified_time" content="2015-09-10T09:26:35.875Z">
    <meta property="article:tag" content="security">
    <meta property="article:tag" content="vulnerability">
    
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Vulnerabilities in FiberHome HG110 and implications for Movistar">
    <meta name="twitter:description" content="Update 1: Movistar, a day after this post was published, contacted me to solve the security problems. In this article I'll show two vulnerabilities found in the router FiberHome HG-110, provided by Movistar in large numbers to its clients in...">
    <meta name="twitter:url" content="http://www.spect.cl/blog/2012/02/vulnerabilities-in-fiberhome-hg110-and-implications-for-movistar/">
    
    <script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "Article",
    "publisher": "SPECT Research",
    "author": {
        "@type": "Person",
        "name": "Claudio Salazar",
        "image": "//www.gravatar.com/avatar/134e22ab3b4cac1e783f88f84917bc12?s=250&d=mm&r=x",
        "url": "http://www.spect.cl/author/claudio",
        "sameAs": null,
        "description": null
    },
    "headline": "Vulnerabilities in FiberHome HG110 and implications for Movistar",
    "url": "http://www.spect.cl/blog/2012/02/vulnerabilities-in-fiberhome-hg110-and-implications-for-movistar/",
    "datePublished": "2012-02-22T12:00:00.000Z",
    "dateModified": "2015-09-10T09:26:35.875Z",
    "keywords": "security, vulnerability",
    "description": "Update 1: Movistar, a day after this post was published, contacted me to solve the security problems. In this article I&#x27;ll show two vulnerabilities found in the router FiberHome HG-110, provided by Movistar in large numbers to its clients in..."
}
    </script>

    <meta name="generator" content="Ghost 0.7">
    <link rel="alternate" type="application/rss+xml" title="SPECT Research" href="http://www.spect.cl/rss/">
    <script>
var disqus_shortname = 'spectresearch';
var ga_id = 'UA-18043187-1';
</script>
</head>

<body><header class="main-header no-cover">
    <div class="vertical">
        <div class="main-header-content inner">
            <h1 class="page-title">SPECT Research</h1>
            <h2 class="page-description">Security and Software Development</h2>
            <br>
            <div>
              <a class="spectnav" href="/"><i class="fa fa-home"></i> Home</a>
              <a class="spectnav" href="/about/"><i class="fa fa-group"></i> About us</a>
              <a class="spectnav" href="/projects/"><i class="fa fa-copy"></i> Projects</a>
              <a class="spectnav" href="/education/"><i class="fa fa-book"></i> Education</a>
            </div>
            <div>
              <a class="spectnav" href="http://github.com/spectresearch"><i class="spectnav fa fa-github"></i></a>
              <a class="spectnav" href="http://twitter.com/spectresearch"><i class="spectnav fa fa-twitter"></i></a>
            </div>
        </div>
    </div>
    <a class="scroll-down icon-arrow-left" href="#content" data-offset="-45"><span class="hidden">Scroll Down</span></a>
</header>



    

    <div class="site-wrapper">

        


<main class="content" role="main">
    <article class="post tag-security tag-vulnerability">

        <header class="post-header">
            <h1 class="post-title">Vulnerabilities in FiberHome HG110 and implications for Movistar</h1>
            <section class="post-meta">
                <time class="post-date" datetime="2012-02-22">22 February 2012</time>  on <a href="/tag/security/">security</a>, <a href="/tag/vulnerability/">vulnerability</a>
            </section>
        </header>

        <section class="post-content">
            <p><strong>Update 1: Movistar, a day after this post was published, contacted me to solve the security problems.</strong></p>

<p>In this article I'll show two vulnerabilities found in the router <em>FiberHome HG-110</em>, provided by <em>Movistar</em> in large numbers to its clients in the last time. I must clarify I'm currently a client of <em>Movistar Banda Ancha Hogar</em> and I have the prior mentioned router, being the purpose of this research to inform its clients and <em>Movistar</em> pays attention in answer to these vulnerabilities.</p>

<p><img src="http://cdn.spect.cl/blog/posts/images/fiberhome-hg110.png%20" style="height:400px; width:500px"></p>

<p>Firstly, this report begins with a briefly analysis of known vulnerabilities so far. Then I describe in general terms the discovered vulnerabilities and the videos of the exploits in execution, to demonstrate the severity of the vulnerabilities and neither the vulnerable page nor exploit code I'm going to make public at this moment. The third part are the workarounds that the clients can put in practice to avoid being victims of attacks exploiting these vulnerabilities. In the end, I present a study about <em>Movistar</em> network, the number of routers <em>FiberHome HG-110</em> and the security implication that these vulnerabilities have, with the timeline of responsible report of them.</p>

<h2 id="priorvulnerabilities">Prior vulnerabilities</h2>

<p>Zerial, <a href="http://blog.zerial.org/seguridad/vulnerabilidad-en-todos-los-routers-fiberhome-hg-110-de-telefonicamovistar/">in April 2011</a>, disclosed <em>Local File Include</em> and <em>Cross Site Scripting</em> vulnerabilities in the router FiberHome HG-110. Then in August, <a href="http://hackstuffs.blogspot.com/2011/08/movistar-entrega-routers-con-falla-de.html">MSH Inc</a> published a further review of issues with text plain files and remote scenarios. Other web pages like <a href="http://www.minuevohogar.cl/index.php/?p=14215">MiNuevoHogar</a> or <a href="http://www.taringa.net/posts/info/9682459.R/Problemas-con-movistar-y-su-nuevo-router-fiberhome-hg110.html">Taringa</a> have posts with information about router credentials and how to configure  the router.</p>

<h2 id="discoveredvulnerabilities">Discovered vulnerabilities</h2>

<p>The discovered vulnerabilities represent a higher degree of severity than currently known ones. Next I show the videos of exploits in execution, but I'm not describing details that could lead to vulnerability discovery. It's necessary to clarify two things about the videos:</p>

<ul>
<li>The remote host, that exploits the vulnerabilities in the router, is located in an external network (Internet) and not inside the local network.</li>
<li>The vulnerabilities affect services at ports 80, 443 and 8000. These last two are commonly opened towards Internet.</li>
</ul>

<h3 id="remoteaccesstosshasroot">Remote access to SSH as <em>root</em></h3>

<iframe width="560" height="315" src="https://www.youtube.com/embed/KHSdveTRFCo?rel=0" frameborder="0" allowfullscreen></iframe>

<h3 id="remotecommandinjection">Remote command injection</h3>

<iframe width="560" height="315" src="https://www.youtube.com/embed/lKiTiNf0H74?rel=0" frameborder="0" allowfullscreen></iframe>

<h2 id="workaroundsforthevulnerabilities">Workarounds for the vulnerabilities</h2>

<p>Since the vulnerabilities are in the services available through the ports 80, 443 and 8000, the router must reject the access to them from an external host. The configuration of the router is a bit complicated to set up firewall rules, though through <em>SSH</em> and <em>iptables</em> it gets easier. The quick solution showed here it's not ideal but it works.</p>

<p>The router has management control over the services it offers. The administration interface is at the port 8000 and you must go to the section "Management / Access Controls / Services". What I  did was to configure the <em>FTP</em> service at the port 8000 and <em>Telnet</em> service at the port 443, and allow access only from inside the <em>LAN</em>. I chose those services because I don't use <br>
them. A screenshot shows the final situation.</p>

<p><img src="http://cdn.spect.cl/blog/posts/images/fiberhome-hg110-settings.png" style="height:400px; width:500px"></p>

<h2 id="implicationsformovistar">Implications for Movistar</h2>

<p>The router <em>FiberHome HG-110</em> is currently being installed by <em>Movistar</em>. In the case an old modem fails or clients require more bandwidth, they will encourage you to accept this new router. Here I present a little study about the participation of this router in the network of <em>Movistar Chile</em> and I conclude with some conclusions about it.</p>

<p>The size of the sample was 68974 hosts that replied successfully the following queries:</p>

<ul>
<li>Ping</li>
<li>Port scanning at ports 22, 80, 443, 8000</li>
<li>NETBios Query</li>
</ul>

<p>This sample was obtained a Sunday day in the afternoon, during a lapse of three to four hours to avoid the router repetition in the sample due to connection/disconnection. Subsequently the sample was analyzed through search of patterns in the router responses, giving the following results:</p>

<ul>
<li>In the <em>NETBIOS</em> query, 13859 hosts replied with the string
<code>HOME\BAMOVISTARWIFI@BAMOVISTARWIFI [00-00-00-00-00-00]</code>, which is a sign that it's the router <em>FiberHome HG-110</em>. This means that currently over 20% of the clients had the router and the trend points out this number will grow up on the time.</li>
<li>13204 hosts of the prior 13859 hosts had the router with ports 443 and 8000 opened. It corresponds to more than 95% of the clients.</li>
</ul>

<p>The routers <em>FiberHome HG-110</em> come with a daemon that often checks for new firmware updates. Today, with the latest  firmware, 19% of the hosts of <em>Movistar</em> network would be vulnerable to the vulnerabilities here described. Although the remote access as <em>root</em> couldn't be successful, the command injection vulnerability will be in most cases.</p>

<p>The vulnerabilities here described can favor the implantation of sniffers in client routers. There are a large number of attacks that an attacker can do, since all the data have to go through the router. Ideas like a botnet can be feasible as there are thousands of vulnerable routers.</p>

<p>Regarding with the notification of these security problems, in January 2012 I tried to contact <em>Movistar</em> through its helpdesk. An employee replied me he couldn't pass the problem up the chain, so he suggested me to go to an office. In February 2012 I sent an e-mail to <em>FiberHome</em>, the router vendor, which one wasn't answered. As in both cases, the probability of answer is <br>
low or none, I made public this information.</p>

<h2 id="conclusions">Conclusions</h2>

<p>It's worrying to me, as <em>Movistar</em> client as security researcher, the severity of the discovered vulnerabilities. This router is currently being distributed in other countries like Colombia and Argentina, so the vulnerable clients grow up in an exponential way. I expect that <em>Movistar</em> contact me to resolve this security problems in a responsible way and they give a patch for their clients.</p>
        </section>

        <footer class="post-footer">


            <figure class="author-image">
                <a class="img" href="/author/claudio/" style="background-image: url(//www.gravatar.com/avatar/134e22ab3b4cac1e783f88f84917bc12?s=250&amp;d=mm&amp;r=x)"><span class="hidden">Claudio Salazar's Picture</span></a>
            </figure>

            <section class="author">
                <h4><a href="/author/claudio/">Claudio Salazar</a></h4>

                    <p>Read <a href="/author/claudio/">more posts</a> by this author.</p>
                <div class="author-meta">
                    
                    
                </div>
            </section>


            <section class="share">
                <h4>Share this post</h4>
                <a class="icon-twitter" href="https://twitter.com/share?text=Vulnerabilities%20in%20FiberHome%20HG110%20and%20implications%20for%20Movistar&amp;url=http://www.spect.cl/blog/2012/02/vulnerabilities-in-fiberhome-hg110-and-implications-for-movistar/" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                    <span class="hidden">Twitter</span>
                </a>
                <a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=http://www.spect.cl/blog/2012/02/vulnerabilities-in-fiberhome-hg110-and-implications-for-movistar/" onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
                    <span class="hidden">Facebook</span>
                </a>
                <a class="icon-google-plus" href="https://plus.google.com/share?url=http://www.spect.cl/blog/2012/02/vulnerabilities-in-fiberhome-hg110-and-implications-for-movistar/" onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
                    <span class="hidden">Google+</span>
                </a>
            </section>

        <footer class="post comments">
  <div id="disqus_thread"></div>
  <script type="text/javascript">
  (function() {
  var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
  dsq.src = '//' + window.disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</footer>

        </footer>

    </article>
</main>

<aside class="read-next">
    <a class="read-next-story no-cover" href="/blog/2012/11/security-analysis-of-servels-case/">
        <section class="post">
            <h2>Security analysis of Servel's case</h2>
            <p>A lot of time ago, there was an incident related to citizenship privacy in Chile and many people, even…</p>
        </section>
    </a>
    <a class="read-next-story prev no-cover" href="/blog/2011/12/security-in-chile-task-of-everyone/">
        <section class="post">
            <h2>Security in Chile, task of everyone</h2>
            <p>In SPECT Research we're in favor of responsible vulnerability notification, giving some time to developers to make the necessary…</p>
        </section>
    </a>
</aside>



        <footer class="site-footer clearfix">
            <section class="copyright"><a href="http://www.spect.cl">SPECT Research</a> © 2016</section>
        </footer>

    </div>

    <!-- You can safely delete this line if your theme does not require jQuery -->
<script type="text/javascript" src="https://code.jquery.com/jquery-1.11.3.min.js"></script>
    <script>
  if (window.ga_id) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', window.ga_id, 'auto');
    ga('require', 'linkid', 'linkid.js');
    ga('send', 'pageview');
  }
</script>

    <script type="text/javascript" src="/assets/js/prism.js?v=c874ada865"></script>
    <script type="text/javascript" src="/assets/js/jquery.fitvids.js?v=c874ada865"></script>
    <script type="text/javascript" src="/assets/js/index.js?v=c874ada865"></script>


</body>